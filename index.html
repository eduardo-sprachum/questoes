<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Banco de Quest√µes</title>
  <link rel="stylesheet" href="style.css">

  <!-- Firebase SDKs -->
  <script type="module">
    // üîπ Importa os m√≥dulos do Firebase
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    // üîπ CONFIGURA√á√ÉO DO FIREBASE (substitua com SUAS CHAVES!)
    const firebaseConfig = {
        apiKey: "AIzaSyD0qF3AkrrQO3XfjUC6xQl6bncrlFgURa8",
        authDomain: "questoes-7614e.firebaseapp.com",
        projectId: "questoes-7614e",
        storageBucket: "questoes-7614e.firebasestorage.app",
        messagingSenderId: "751632344545",
        appId: "1:751632344545:web:4613ee92692f5d527cdea0",
        measurementId: "G-DS8N95SV31"
    };

    // Inicializa Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // üîπ C√≥digos das disciplinas
    const codigosDisciplina = {
      "Arte": "ART",
      "Biologia": "BIO",
      "Educa√ß√£o F√≠sica": "EDF",
      "F√≠sica": "FIS",
      "Filosofia": "FIL",
      "Geografia": "GEO",
      "Hist√≥ria": "HIS",
      "Portugu√™s": "POR",
      "Ingl√™s": "ING",
      "Espanhol": "ESP",
      "Franc√™s": "FRA",
      "Qu√≠mica": "QUI",
      "Sociologia": "SOC",
      "Matem√°tica": "MAT",
      "Literatura": "LIT"
    };

    // üîπ Captura o formul√°rio
    const salvarQuestao = async (event) => {
      event.preventDefault();

      const universidade = document.getElementById("universidade").value;
      const ano = document.getElementById("ano").value;
      const disciplina = document.getElementById("disciplina").value;
      const eixo = document.getElementById("eixo").value;
      const assunto = document.getElementById("assunto").value;
      const enunciado = document.getElementById("enunciado").value;
      const altA = document.getElementById("altA").value;
      const altB = document.getElementById("altB").value;
      const altC = document.getElementById("altC").value;
      const altD = document.getElementById("altD").value;
      const altE = document.getElementById("altE").value;

      try {
        // Conta quantas quest√µes da disciplina j√° existem
        const q = query(collection(db, "questoes"), where("disciplina", "==", disciplina));
        const snapshot = await getDocs(q);
        const numero = snapshot.size + 1;

        // Gera c√≥digo
        const disciplinaCodigo = codigosDisciplina[disciplina];
        const numeroFormatado = String(numero).padStart(5, "0");
        const codigoQuestao = disciplinaCodigo + numeroFormatado;

        // Salva no Firestore
        await addDoc(collection(db, "questoes"), {
          codigo: codigoQuestao,
          universidade,
          ano,
          disciplina,
          eixo,
          assunto,
          enunciado,
          alternativas: { A: altA, B: altB, C: altC, D: altD, E: altE },
          criadoEm: new Date()
        });

        alert(`Quest√£o cadastrada com sucesso! C√≥digo: ${codigoQuestao}`);
        document.getElementById("questaoForm").reset();
      } catch (error) {
        console.error("Erro ao salvar quest√£o: ", error);
        alert("Erro ao salvar quest√£o!");
      }
    };

    window.salvarQuestao = salvarQuestao;
  </script>
</head>
<body>
  <div class="container">
    <h1>Banco de Quest√µes</h1>

    <form id="questaoForm" onsubmit="salvarQuestao(event)">
<label>Universidade:</label>
<select id="universidade" required>
  <option value="">Selecione</option>
  <option>UEPG</option>
  <option>UEM</option>
  <option>UEL</option>
  <option>UNIOESTE</option>
  <option>UNICENTRO</option>
  <option>UFPR</option>
  <option>IFPR</option>
  <option>ENEM</option>
  <option>UNESPAR</option>
  <option>UENP</option>
</select>

<label>Ano:</label>
<input type="number" id="ano" required>

<label>Disciplina:</label>
<select id="disciplina" required>
  <option value="">Selecione</option>
  <option>Arte</option>
  <option>Biologia</option>
  <option>Educa√ß√£o F√≠sica</option>
  <option>F√≠sica</option>
  <option>Filosofia</option>
  <option>Geografia</option>
  <option>Hist√≥ria</option>
  <option>Portugu√™s</option>
  <option>Ingl√™s</option>
  <option>Espanhol</option>
  <option>Franc√™s</option>
  <option>Qu√≠mica</option>
  <option>Sociologia</option>
  <option>Matem√°tica</option>
  <option>Literatura</option>
</select>

<label>Eixo Tem√°tico:</label>
<select id="eixo" required>
  <option value="">Selecione uma disciplina primeiro</option>
</select>

<label>Assunto:</label>
<select id="assunto" required>
  <option value="">Selecione um eixo primeiro</option>
</select>

<label>Enunciado:</label>
<textarea id="enunciado" required></textarea>

<!-- üîπ √Årea din√¢mica para alternativas ou somat√≥rio -->
<div id="alternativasContainer">
  <!-- Aqui o JS vai injetar os inputs corretos -->
</div>
      <button type="submit">Adicionar Quest√£o</button>
    </form>
  </div>
    <script type="module" src="script.js"></script>
</body>
</html>
